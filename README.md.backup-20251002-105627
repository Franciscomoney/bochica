# Bochica - Decentralized Micro-Lending Platform

A blockchain-powered micro-lending platform built on Polkadot's parachain architecture, enabling investors to fund projects and entrepreneurs to access capital with transparent, on-chain transactions.

## 🚀 Current Status: MVP Deployed on OVH

**Live Demo**: https://51.178.253.51:8100

**Admin Dashboard**: https://51.178.253.51:8100/admin
- Username: `admin`
- Password: `Bochica2025!`

---

## ✅ Recent Changes (October 2025)

### Migration to OVH Server
- **Moved from Vultr to OVH** (51.178.253.51:8100)
- Running on PM2 for process management
- HTTPS with self-signed certificates
- Supabase connected and working

### Kickstarter-Style UI Redesign
- **Purple-themed branding** (#7C3AED)
- **BOCHICA logo** in purple text
- **Kickstarter-like project cards** with image placeholders
- **Account dropdown** with balance display
- Cleaner navigation: "Discover" and "Start a project"
- Thin progress bars matching Kickstarter style

### Custom Interest Rates
- **Creators can set their own interest rate** (0-100%)
- Interest rate field added to project creation form
- Database migration required: `interest_rate DECIMAL(5, 2)` column

### Working Features
- ✅ **Project Creation** - Full CRUD with Supabase
- ✅ **Project Browsing** - Grid view with real data
- ✅ **Project Details** - Individual project pages
- ✅ **Admin Dashboard** - Stats and transaction monitoring
- ✅ **Role Switcher** - Toggle between Investor/Creator
- ✅ **Wallet Integration** - Talisman connection working
- ✅ **Real-time Balances** - Asset Hub & Moonbeam

---

## 📁 Project Structure

```
bochica/
├── app/
│   ├── layout.tsx              ✅ Main layout with WalletProvider
│   ├── page.tsx                ✅ Home with role switcher
│   ├── projects/page.tsx       ✅ Browse projects (Kickstarter style)
│   ├── create-project/page.tsx ✅ Create project with interest rate
│   ├── project/[id]/page.tsx   ✅ Project detail view
│   ├── admin/
│   │   ├── page.tsx            ✅ Admin login
│   │   └── dashboard/page.tsx  ✅ Admin dashboard
│   └── api/
│       └── auth/admin/route.ts ✅ Admin authentication
├── components/
│   └── Header.tsx              ✅ Purple logo + dropdown
├── contexts/
│   └── WalletContext.tsx       ✅ Wallet state management
├── lib/
│   ├── supabase.ts             ✅ Database client
│   ├── polkadot.ts             ✅ Blockchain integration
│   └── financial.ts            ✅ Financial calculations
├── supabase-setup.sql          ✅ Initial database schema
├── add-interest-rate.sql       ✅ Migration for interest rates
└── .env.local                  ✅ Environment variables
```

---

## 🎨 UI/UX Changes

### Header
- Purple "BOCHICA" logo (SVG text)
- Navigation links: "Discover" | "Start a project"
- Account dropdown with:
  - User avatar (initials)
  - Wallet address
  - Asset Hub balance
  - Moonbeam balance
  - Disconnect button

### Projects Page
- Kickstarter-style card layout
- Purple gradient image placeholders
- "FUNDED" badge for completed projects
- Thin progress bars
- "pledged of $X" language
- Hover effects on titles

### Color Scheme
- **Primary**: Purple (#7C3AED)
- **Success**: Green (#10B981)
- **Background**: Gray (#F9FAFB)

---

## 🔧 Database Schema Updates

### New Column: `interest_rate`
Run this migration in Supabase SQL Editor:

```sql
ALTER TABLE projects
ADD COLUMN IF NOT EXISTS interest_rate DECIMAL(5, 2) DEFAULT 5.00;

COMMENT ON COLUMN projects.interest_rate IS 'Interest rate the creator is willing to pay (0-100%)';
```

### Complete Tables
- ✅ `projects` - With interest_rate field
- ✅ `commitments` - Investor commitments
- ✅ `loans` - Borrower loans
- ✅ `transactions` - All financial movements
- ✅ `user_balances` - Balance tracking

---

## 🛠️ Tech Stack

**Frontend**:
- Next.js 14 (App Router)
- React 18
- TypeScript
- Tailwind CSS

**Blockchain**:
- Polkadot.js API
- Talisman Wallet
- XCM Protocol
- Asset Hub (USDT storage)
- Moonbeam (operations)

**Backend**:
- Next.js API Routes
- Supabase (PostgreSQL)
- PM2 Process Manager
- HTTPS (self-signed cert)

---

## 🚀 Deployment (OVH Server)

**Server**: 51.178.253.51
**Port**: 8100 (HTTPS)
**PM2 Process**: `bochica`

### PM2 Commands
```bash
# SSH to OVH
ssh -i /root/coding/claudecode/projects/ovh/keys/ovh_master debian@51.178.253.51

# Manage process
pm2 list
pm2 restart bochica
pm2 logs bochica
pm2 stop bochica
```

### File Location
`/home/debian/bochica/`

---

## ⏳ Pending Features

### Investment Workflow
- [ ] Commit funds to projects
- [ ] XCM transfer UI (Asset Hub → Moonbeam)
- [ ] Lockup period selection
- [ ] Investment history

### Borrowing Workflow
- [ ] Borrow against funded amount
- [ ] Repayment with custom interest
- [ ] Loan status tracking
- [ ] Automatic interest calculation

### Project Editing
- [ ] Edit project details
- [ ] Update interest rate
- [ ] Change funding goal
- [ ] Project status management

### User Dashboard
- [ ] Portfolio overview
- [ ] Investment summary
- [ ] Created projects list
- [ ] Transaction history

### Additional Features
- [ ] Search projects
- [ ] Filter by category
- [ ] Real-time updates (Supabase subscriptions)
- [ ] Email notifications
- [ ] Project images upload
- [ ] Comments/updates

---

## 📊 Financial Rules

- **Platform Fee**: 2% on commitments and redemptions
- **Loan Interest**: Creator-defined (0-100%, default 5%)
- **Lockup Periods**: 24h, 72h, or 7 days
- **Lockup Enforcement**: Only when funds are borrowed

---

## 🔐 Security

**Current State** (Development):
- Self-signed SSL certificate
- Basic authentication for admin
- Supabase RLS policies enabled
- HTTP-only cookies for sessions

**Before Production**:
- [ ] Get proper SSL certificate (Let's Encrypt)
- [ ] Implement rate limiting
- [ ] Add CSRF protection
- [ ] Security audit
- [ ] Input sanitization
- [ ] Penetration testing

---

## 📝 Environment Variables

```env
# Supabase (Production)
NEXT_PUBLIC_SUPABASE_URL=https://fvehyzvdffnxrmupwgtv.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key

# Polkadot RPC Endpoints
NEXT_PUBLIC_ASSET_HUB_WSS=wss://polkadot-asset-hub-rpc.polkadot.io
NEXT_PUBLIC_MOONBEAM_WSS=wss://wss.api.moonbeam.network

# Platform Configuration
NEXT_PUBLIC_PLATFORM_FEE=0.02
NEXT_PUBLIC_USDT_ASSET_ID=1984

# Admin Credentials
ADMIN_USERNAME=admin
ADMIN_PASSWORD=Bochica2025!
```

---

## 🎯 Roadmap

**Phase 1**: ✅ Foundation (Complete)
- Wallet integration
- Database setup
- Admin dashboard
- Project CRUD

**Phase 2**: 🚧 Investment Features (In Progress)
- Investment workflow
- XCM transfers
- Borrowing system
- Repayment system

**Phase 3**: ⏳ Polish
- Real-time updates
- Notifications
- Search & filters
- Analytics

**Phase 4**: ⏳ Production
- Security audit
- Proper SSL
- Performance optimization
- Launch

---

## 📄 Admin Access

**URL**: https://51.178.253.51:8100/admin

**Features**:
- View all projects
- Monitor total funding
- Track active loans
- View platform fees collected
- See investor/borrower counts
- Recent transactions log

---

## 🆘 Troubleshooting

### Can't connect to OVH
```bash
# Use OVH management tool
/root/coding/claudecode/projects/ovh/ovh connect ovh-debian
```

### Database migration failed
1. Go to Supabase SQL Editor
2. Run migration SQL directly
3. Refresh page

### PM2 process crashed
```bash
pm2 restart bochica
pm2 logs bochica --lines 50
```

---

**Last Updated**: October 2, 2025
**Status**: MVP deployed, investment features pending
**License**: MIT
